---
title: "cutout"
author: "Nico Binder"
date: "2023-01-27"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{sql}


```


```{sql connection=con}
create temporary VIEW temp_idx_all as
SELECT * FROM raw_data 
WHERE variable_id = 1 and 
```

### create view on this terms hobos temperature

```{sql connection=con}

create temporary VIEW temps_232222 as
SELECT * FROM raw_data
WHERE variable_id = 1 and meta_id between 215 and 242

```


Using order by desc (I also checked the first few but there seems to be a HOBO missing) 
```{sql connection=con}

select * from temps_232222
order by meta_id

```

## mean temperature of all this years hobos
*	Mean temperature

```{sql connection=con}

select avg(value) from temps_232222


```

## all hobo day

create view
```{sql connection=con}
create temporary VIEW all_index_day as
SELECT * FROM raw_data 
WHERE variable_id = 1 and meta_id between 215 and 242 and date_part('hour', tstamp) <= 18 and date_part('hour', tstamp) >=8


```

extract daily mean
```{sql connection=con}
select avg(value) from all_index_day
```

## all hobo night
hobo nights sure sounds like a song from the 80s

```{sql connection=con}

create temporary VIEW all_index_night as
SELECT * FROM raw_data 
WHERE variable_id = 1 and meta_id between 215 and 242 and date_part('hour', tstamp) <= 8 and date_part('hour', tstamp) <= 18

```
extract mean

```{sql connection=con}
select avg(value) from all_index_night

```


## 5.4	Switch the dataset (max. 150 words)

<div class="alert alert-info">
Now apply the same query used in the last task again, but for the other kind of data.
</div>
overview of quality controlled data
```{sql connection=con}
create temporary VIEW all_qc_temp as
select * from data 
where variable_id = 1 and
meta_id between 215 and 242

```

## all qc temp mean

```{sql connection=con}
select avg(value) from all_qc_temp

```

## all qc night mean
```{sql connection=con}
create temporary VIEW all_qc_temp_night as
select * from data 
where variable_id = 1 and
meta_id between 215 and 242 and
date_part('hour', tstamp) <= 8 and date_part('hour', tstamp) <= 18
```

```{sql connection=con}
select avg(value) from all_qc_temp_night

```

# all qc day mean
```{sql connection=con}
create temporary VIEW all_qc_temp_day as
select * from data 
where variable_id = 1 and
meta_id between 215 and 242 and
date_part('hour', tstamp) <= 18 and date_part('hour', tstamp) >=8
```

```{sql connection=con}
select avg(value) from all_qc_temp_day
```

## length and coefficient of variation on qc data
### qc coeff.var.
```{sql connection = con}
create temporary view all_qc_varco as
SELECT stddev_samp(value) / AVG(value) from all_qc_temp_day

```
```{sql connection = con}
select * from all_qc_varco
```
### qc length
```{sql connection = con}
create temporary view qc_length2 as
select count(distinct tstamp) from
all_qc_temp
  

```

```{sql connection=con}
select * from qc_length2

```
### raw length
```{sql connection = con}
create temporary view raw_length as
select count(distinct tstamp) from
temps_232222
  

```

```{sql connection=con}
select * from raw_length

```